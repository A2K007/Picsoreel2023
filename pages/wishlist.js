import Head from 'next/head'
import Link from 'next/link'
import { useState , useEffect} from 'react'

export default function Wishlist() {
  const [isloggedin, setIsLoggedIn] = useState(false)
  const checkifuser = async () => {
    const loggedInUser = localStorage.getItem("user");
    const resh = await fetch(`http://localhost:3000/api/checkadmin/${loggedInUser}`)
    const data = await resh.json()
    if (data.name !== "notuser") {
      setIsLoggedIn(true)
    }
  }
  
  const logout = async name => {
    localStorage.removeItem('user');
  }
  //displaying all the images with category painting from atlas
  const [paintings, setPainting] = useState([])
  const [photographys, setPhotography] = useState([])
  const [digitalarts, setDigitalart] = useState([])
  const [themes, setTheme] = useState([])
  
  const getcat = async cate => {
    // console.log(loggedInUser)
    const loggedInUser = localStorage.getItem('user')
    const res = await fetch('http://localhost:3000/api/getWishlist', {
      method: 'POST',
      body: JSON.stringify({  category : cate, username : loggedInUser}),
      headers: {
        'Content-Type': 'application/JSON'
      }
    })
    const data = await res.json()
    setPainting(data)
    console.log(data)
  }
  
  const loadallimages = () => {
    getcat("painting")
    getcat("photo")
    getcat("theme")
    getcat("digital")
  }
  useEffect(() => {
    checkifuser(),
    loadallimages()
  }, []);
  
  return (
    <>
      <Head>
        <title>My Wishlist</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <div>
        <h1>This is My Wishlists Page</h1>
        <Link href="/feedback"><button>Final Submit</button></Link><br></br>
        <div>
          <div>
            {/* <button onClick={() => loadallimages()}>Show all entries</button> */}
            <p>Painting/Sketches</p>
            {
              paintings.map((painting) => {
                return (
                  <>
                    <div key={painting.image_id}>
                      {painting.name} | {painting.category} | {painting.class}
                    </div>
                    <img src={painting.url}></img>
                    <button>Delete</button>
                  </>
                )
              })
            }
          </div>
          <div>
            <p>Photography</p>

          </div>
          <div>
            <p>Digital Art</p>

          </div>
          <div>
            <p>Theme</p>

          </div>
        </div>
      </div>
    </>
  )
}